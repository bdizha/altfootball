!function(){function a(b,c){function d(a,b,c,d){if("object"!=typeof h&&"function"!=typeof h||"function"!=typeof a)d();else try{var e=0;a.call(h,function(a){e++||(h=a,b())},function(a){e++||(h=a,c())})}catch(f){h=f,c()}}function e(){var a;try{a=h&&h.then}catch(i){return h=i,g=2,e()}d(a,function(){g=1,e()},function(){g=2,e()},function(){try{1==g&&"function"==typeof b?h=b(h):2==g&&"function"==typeof c&&(h=c(h),g=1)}catch(e){return h=e,j()}h==f?(h=TypeError(),j()):d(a,function(){j(3)},j,function(){j(1==g&&3)})})}var f=this,g=0,h=0,i=[];f.promise=f,f.resolve=function(a){return g||(h=a,g=1,e()),this},f.reject=function(a){return g||(h=a,g=2,e()),this},f.then=function(b,c){var d=new a(b,c);return 3==g?d.resolve(h):4==g?d.reject(h):i.push(d),d};var j=function(a){g=a||4,i.map(function(a){3==g&&a.resolve(h)||a.reject(h)})}}function b(a){function b(){return arguments.length&&(a=arguments[0]),a}return b.toJSON=function(){return a},b}function c(a,d){return a.then=function(){var e=b(a());return c(e,d.then.apply(d,arguments).then(e))},a.promise=a,a.resolve=function(b){return a(b),d=d.resolve.apply(d,arguments),a},a.reject=function(){return d=d.reject.apply(d,arguments),a},a}"undefined"!=typeof module?module.exports={deferred:function(){return c(b(),new a)}}:this.Promiz=a}();